<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="{{ url_for('static', filename='css/global.css') }}">
		<title>Pages</title>
		<style>
			.table td,
			.table th {
				vertical-align: middle;
			}

			.col-page-id {
				width: 140px;
			}

			.col-name {
				width: 200px;
			}

			.col-category {
				width: 150px;
			}

			.col-token {
				width: 300px;
				max-width: 300px;
			}

			.token-content {
				max-height: 2.4em;
				/* Khoảng 2 dòng */
				overflow: hidden;
				text-overflow: ellipsis;
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
			}

			.col-expires {
				width: 120px;
			}

			.col-account-id {
				width: 120px;
			}

			.copy-btn {
				padding: 2px 8px;
				font-size: 0.8em;
				margin-left: 5px;
			}

			.token-wrapper {
				display: flex;
				align-items: flex-start;
				gap: 8px;
			}
		</style>
	</head>
	<body>
		{% include 'header.html' %}
		{% include 'message.html' %}

		<div class="container mt-5">
			<h1 class="mb-4">List of Pages</h1>
			<div class="table-responsive">
				<table class="table table-striped table-bordered table-hover">
					<thead class="table-dark">
						<tr>
							<th class="col-page-id">Page ID</th>
							<th class="col-name">Page Name</th>
							<th class="col-category">Category</th>
							<th class="col-token">Access Token</th>
							<th class="col-expires">Expires At</th>
							<th class="col-account-id">Facebook Account ID</th>
						</tr>
					</thead>
					<tbody>
						{% for page in pages %}
						<tr>
							<td class="col-page-id">{{ page.page_id }}</td> <!-- Sử dụng page.page_id -->
							<td class="col-name">{{ page.name }}</td> <!-- Sử dụng page.name -->
							<td class="col-category">{{ page.category }}</td> <!-- Sử dụng page.category -->
							<td class="col-token">
								<div class="token-wrapper">
									<div class="token-content">{{ page.access_token }}</div> <!-- Sử dụng page.access_token -->
									<button class="btn btn-sm btn-outline-primary copy-btn"
										onclick="copyToken(this, '{{ page.access_token }}')" title="Copy token">
										Copy
									</button>
								</div>
							</td>
							<td class="col-expires">{{ page.expires_at }}</td> <!-- Sử dụng page.expires_at -->
							<td class="col-account-id">{{ page.facebook_account_id }}</td> <!-- Sử dụng page.facebook_account_id -->
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>

		<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
		<script>
			function copyToken(button, token) {
				navigator.clipboard.writeText(token).then(() => {
					button.textContent = 'Copied!';
					button.classList.remove('btn-outline-primary');
					button.classList.add('btn-success');

					setTimeout(() => {
						button.textContent = 'Copy';
						button.classList.remove('btn-success');
						button.classList.add('btn-outline-primary');
					}, 2000);
				}).catch(err => {
					console.error('Failed to copy:', err);
					button.textContent = 'Error';
					button.classList.add('btn-danger');
				});
			}
		</script>
	</body>
</html>